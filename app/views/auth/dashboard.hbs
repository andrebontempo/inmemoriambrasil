<main class="container my-5">
  <h2 class="text-center">
    Bem-vindo(a), {{user.firstName}} {{user.lastName}}!
  </h2>
  <p class="text-center">Voc√™ est√° logado(a).</p>

  <!-- Bot√£o Sair -->
  <div class="text-end mb-4">
    <a href="/auth/logout" class="btn btn-primary">Sair</a>
  </div>

  <p class="text-center">
    <strong>Aqui est√£o os memoriais que voc√™ criou:</strong>
  </p>

  {{#if memoriais.length}}
  <div class="list-group">

    {{#each memoriais}}
    <div class="list-group-item d-flex align-items-start justify-content-between flex-wrap position-relative">

      <!-- ‚≠ê Selo Premium -->
      {{#if (eq this.plan "premium")}}
      <span class="badge bg-warning text-dark position-absolute top-0 end-0 m-2">
        ‚≠ê Premium
      </span>
      {{/if}}

      <!-- BLOCO PRINCIPAL -->
      <div class="d-flex align-items-start w-100">

        <!-- FOTO -->
        <a href="/memorial/{{this.slug}}" class="me-3">
          {{#if this.mainPhoto.url}}
          <img src="{{this.mainPhoto.url}}" alt="Foto de {{this.firstName}}" class="rounded"
            style="width: 110px; height: 110px; object-fit: cover; border: 2px solid #4f0e21;" />
          {{else}}
          <img src="/images/default-profile.png" alt="Sem foto" class="rounded"
            style="width: 110px; height: 110px; object-fit: cover; border: 2px solid #ccc;" />
          {{/if}}
        </a>

        <!-- INFORMA√á√ïES -->
        <div class="flex-grow-1">

          <h5 class="mb-2">
            {{this.firstName}} {{this.lastName}}
          </h5>

          <p class="mb-2 small">
            <strong>Nascimento:</strong>
            {{formatDate this.birth.date}}
            <br />
            <strong>Falecimento:</strong>
            {{formatDate this.death.date}}
          </p>

          <!-- LINHA: Visibilidade + Plano -->
          <div class="d-flex flex-wrap align-items-center gap-3 small">

            <!-- üîê Visibilidade -->
            <div>
              <strong>Visibilidade:</strong>

              {{#if (eq this.accessLevel "public_read")}}
              <span class="badge bg-success">P√∫blico</span>
              {{/if}}

              {{#if (eq this.accessLevel "private_read")}}
              <span class="badge bg-secondary">Privado (leitura)</span>
              {{/if}}

              {{#if (eq this.accessLevel "private_edit")}}
              <span class="badge bg-dark">Privado (edi√ß√£o)</span>
              {{/if}}
            </div>

            <!-- üíé Plano -->
            <div>
              <strong>Plano:</strong>

              {{#if (eq this.plan "premium")}}
              <span class="badge bg-warning text-dark">Premium</span>
              {{else}}
              <span class="badge bg-light text-dark border">Free</span>
              {{/if}}
            </div>

          </div>

        </div>

        <!-- BOT√ïES -->
        <div class="ms-auto mt-3 mt-md-0 d-flex flex-wrap gap-2">

          <a href="/memorial/{{this.slug}}" class="btn btn-primary">
            Visitar
          </a>

          <a href="/memorial/{{this.slug}}/memorial-fet/edit" class="btn btn-primary">
            Trocar Foto Principal
          </a>

          <a href="/memorial/{{this.slug}}/memorial/edit" class="btn btn-primary">
            Editar Memorial
          </a>

          <a href="/memorial/{{this.slug}}/memorial/privacy/edit" class="btn btn-primary">
            Privacidade
          </a>

          <form action="/memorial/{{this.slug}}/delete" method="POST"
            onsubmit="return confirm('Tem certeza que deseja apagar este memorial? Esta a√ß√£o n√£o poder√° ser desfeita!')">
            <input type="hidden" name="_method" value="DELETE" />
            <button type="submit" class="btn btn-danger">
              Excluir
            </button>
          </form>

        </div>

      </div>

    </div>
    {{/each}}

  </div>

  {{else}}
  <p class="text-center text-muted">
    Voc√™ ainda n√£o criou nenhum memorial.
  </p>
  {{/if}}

</main>